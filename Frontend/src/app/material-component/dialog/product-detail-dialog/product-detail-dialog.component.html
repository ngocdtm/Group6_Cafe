<div class="dialog-scroll-container">
  <div class="dialog-content">
    <div class="dialog-header">
      <h2>{{data.name}}</h2>
      <button mat-icon-button (click)="close()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="content-wrapper">
      <div class="image-gallery">
        <div class="main-image">
          <img [src]="getImageUrl(data.images[selectedImageIndex].imagePath)" [alt]="data.name">
        </div>
        <div class="thumbnail-strip">
          <div *ngFor="let image of data.images; let i = index"
               class="thumbnail"
               [class.active]="i === selectedImageIndex"
               (click)="selectImage(i)">
            <img [src]="getImageUrl(image.imagePath)" [alt]="data.name">
          </div>
        </div>
      </div>

      <div class="product-details">
        <div class="price">{{data.price | currency:'VND':'symbol':'1.0-0'}}</div>
        <div class="description">{{data.description}}</div>
        <div class="additional-info">
          <p><strong>Category:</strong> {{categoryName}}</p>
          <p><strong>Status:</strong> {{data.status ? 'Available' : 'Out of Stock'}}</p>
        </div>
      </div>
    </div>

    <div class="related-products-section">
      <h3>Sản phẩm liên quan</h3>
      
      <!-- Loading state -->
      <div *ngIf="isLoading" class="loading-state">
        <mat-spinner diameter="40"></mat-spinner>
        <p>Đang tải sản phẩm liên quan...</p>
      </div>
    
      <!-- Error state -->
      <div *ngIf="!isLoading && relatedProducts.length === 0" class="no-products">
        Không có sản phẩm liên quan
      </div>
    
      <!-- Products grid -->
      <div *ngIf="!isLoading && relatedProducts.length > 0" class="related-products-grid">
        <div *ngFor="let product of relatedProducts" 
             class="related-product-card"
             (click)="openProduct(product)">
          <div class="product-image">
            <!-- Hiển thị ảnh đầu tiên của sản phẩm -->
            <img *ngIf="product.images && product.images.length > 0"
                 [src]="getImageUrl(product.images[0].imagePath)"
                 [alt]="product.name"
                >
            <!-- Fallback khi không có ảnh -->
            <div *ngIf="!product.images || product.images.length === 0" 
                 class="image-placeholder">
              <mat-icon>image</mat-icon>
            </div>
          </div>
          <div class="product-info">
            <h4>{{product.name}}</h4>
            <p class="price">{{product.price | currency:'VND':'symbol':'1.0-0'}}</p>
            <p class="description">{{product.description}}</p>
          </div>
        </div>
      </div>
    </div>
</div>
